Практика «Уязвимости инъекции команд ОС»

Проанализируйте защищенность механизма работы с процессами ОС на главной странице панели администратора. Обнаружьте и проэксплуатируйте на этой странице уязвимости инъекции команд терминальной оболочки.

В качестве подтверждения успешной эксплуатации предоставьте флаг (секретную строку в формате 32 букв и цифр) из переменных окружения операционной системы.

Переменные окружения можно получить, выполнив команду “export” терминальной оболочки ОС.

Задание продолжается на развёрнутом ранее веб-приложении. Если вы не понимаете откуда взялось веб-приложениее, то рекомендую посмотреть мой репозиторий под названием Stepik-writeup-5.2, а лучше выполнить задания самостоятельно для получения максимального опыта.

<img width="1905" height="957" alt="image" src="https://github.com/user-attachments/assets/4d4dc9aa-cc4e-411d-ac6b-d05d0f499cf3" />

Попробуем отправить разные команды, например посмотреть процессы Apache2

<img width="1908" height="1039" alt="image" src="https://github.com/user-attachments/assets/179306b0-2bef-493d-92d9-e54998a0ddd8" />

Самая простая SQLi, это отправка после точки с запятой какой-либо другой команды. Такая SQLi возможна для реализации, если не написана фильтрация команд, которые отправляются на сервер. Попробуем ввести банальное ls. Команда <apachee2; ls -la>

<img width="1853" height="885" alt="image" src="https://github.com/user-attachments/assets/8448d53e-f58d-47d7-8615-2b1941d3cdcb" />

Как мы видим, сначала выполнилась команда по поиску процессов, а потом наша команда. В задание нам дают совет использовать команду export для получения переменнных процессов. Команда <apache2; export>

<img width="1913" height="1000" alt="image" src="https://github.com/user-attachments/assets/30a4ec12-0a70-43ca-b7d9-5ed8eadaf1ab" />

На скрине мы видим наш заветный флаг. Пробуем ввести его и ура, ответ верный

<img width="924" height="767" alt="image" src="https://github.com/user-attachments/assets/9b011cd3-2989-4f68-8990-9068cc80803c" />
